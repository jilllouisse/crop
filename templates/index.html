<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Recommendation System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Introduction Section -->
        <section class="intro-section" style="background: linear-gradient(135deg, #e0f7fa 0%, #fffde4 100%); border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.07); padding: 2.5rem 2rem 2rem 2rem; margin-bottom: 2.5rem; text-align: center;">
            <img src="{{ url_for('static', filename='images/loam-soil.jpg') }}" alt="Healthy Soil" style="width: 120px; height: 120px; object-fit: cover; border-radius: 50%; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1rem;">
            <h1 style="font-size: 2.5rem; font-weight: 700; color: #388e3c; margin-bottom: 0.5rem;">Welcome to the Philippine Crop Recommendation System</h1>
            <p style="font-size: 1.2rem; color: #444; max-width: 700px; margin: 0 auto 1.2rem auto;">
                Discover the best crops for your land! Our tool helps you match your soil's pH, type, and moisture to the most suitable crops for your region. Just enter your soil details below and get instant, science-backed recommendations for a healthier, more productive farm. <br><br>
                <span style="color: #1976d2; font-weight: 500;">Why use crop recommendations?</span> <br>
                Choosing the right crops for your soil improves yields, conserves resources, and keeps your land healthy year after year—just like crop rotation does for gardens. <br><br>
                <span style="color: #388e3c;">Let's grow smarter, together!</span>
            </p>
        </section>
        <!-- End Introduction Section -->

        <h1>Philippine Crop Recommendation System</h1>

        <div class="info-section">
            <h2>Understanding Soil Types and Moisture Levels</h2>
            
            <div class="info-grid">
                <div class="info-card">
                    <h3>Soil Types</h3>
                    <div class="soil-types">
                        <div class="soil-type">
                            <h4>Loamy Soil</h4>
                            <img src="{{ url_for('static', filename='images/loam-soil.jpg') }}" alt="Loamy Soil" class="soil-image">
                            <p>Loamy soil is considered ideal for most crops because it:</p>
                            <ul>
                                <li>Contains a balanced mixture of sand, silt, and clay</li>
                                <li>Provides excellent drainage while retaining moisture</li>
                                <li>Allows easy root penetration</li>
                                <li>Rich in nutrients and organic matter</li>
                            </ul>
                        </div>

                        <div class="soil-type">
                            <h4>Sandy Soil</h4>
                            <img src="{{ url_for('static', filename='images/sandy-soil.jpg') }}" alt="Sandy Soil" class="soil-image">
                            <p>Sandy soil is light and well-aerated but has some limitations:</p>
                            <ul>
                                <li>Drains water quickly</li>
                                <li>Warms up quickly in spring</li>
                                <li>Lower in nutrients</li>
                                <li>Requires frequent watering</li>
                            </ul>
                        </div>

                        <div class="soil-type">
                            <h4>Clay Soil</h4>
                            <img src="{{ url_for('static', filename='images/clay-soil.jpg') }}" alt="Clay Soil" class="soil-image">
                            <p>Clay soil is nutrient-rich but can be challenging:</p>
                            <ul>
                                <li>Retains water and nutrients well</li>
                                <li>Can become compacted</li>
                                <li>Slow to warm in spring</li>
                                <li>Can be difficult for roots to penetrate</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <h3>Moisture Levels</h3>
                    <div class="moisture-levels">
                        <div class="moisture-type">
                            <h4>Dry Soil</h4>
                            <img src="{{ url_for('static', filename='images/dry-soil.jpg') }}" alt="Dry Soil" class="moisture-image">
                            <p>Characteristics of dry soil:</p>
                            <ul>
                                <li>Appears light in color</li>
                                <li>Crumbly and loose texture</li>
                                <li>Dusty when disturbed</li>
                                <li>Water quickly drains through</li>
                            </ul>
                        </div>

                        <div class="moisture-type">
                            <h4>Moist Soil</h4>
                            <img src="{{ url_for('static', filename='images/moist-soil.jpg') }}" alt="Moist Soil" class="moisture-image">
                            <p>Ideal moisture level for most plants:</p>
                            <ul>
                                <li>Appears dark and rich in color</li>
                                <li>Forms a ball when squeezed</li>
                                <li>Breaks apart easily</li>
                                <li>Perfect balance of water and air</li>
                            </ul>
                        </div>

                        <div class="moisture-type">
                            <h4>Wet Soil</h4>
                            <img src="{{ url_for('static', filename='images/wet-soil.jpg') }}" alt="Wet Soil" class="moisture-image">
                            <p>Signs of overly wet soil:</p>
                            <ul>
                                <li>Appears very dark and glossy</li>
                                <li>Water pools on surface</li>
                                <li>Sticky and moldable</li>
                                <li>Limited air spaces for roots</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-container">
            <h2>Enter Your Soil Parameters</h2>
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
            <form method="POST" action="/">
                <div class="form-group">
                    <label for="ph">Soil pH ({{ min_ph }} - {{ max_ph }}):</label>
                    <input type="number" step="0.1" name="ph" id="ph" value="{{ request.form.ph or '' }}" required min="{{ min_ph }}" max="{{ max_ph }}">
                    <div class="input-help">
                        <p>pH measures soil acidity. Enter a value between {{ min_ph }} and {{ max_ph }} for best results.</p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="soil_type">Soil Type:</label>
                    <select name="soil_type" id="soil_type" required>
                        <option value="">Select Soil Type</option>
                        <option value="loam" {% if request.form.soil_type == 'loam' %}selected{% endif %}>Loam</option>
                        <option value="sandy" {% if request.form.soil_type == 'sandy' %}selected{% endif %}>Sandy</option>
                        <option value="clay" {% if request.form.soil_type == 'clay' %}selected{% endif %}>Clay</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="moisture">Soil Moisture Level:</label>
                    <select name="moisture" id="moisture" required>
                        <option value="">Select Moisture Level</option>
                        <option value="dry" {% if request.form.moisture == 'dry' %}selected{% endif %}>Dry (30–50%)</option>
                        <option value="moist" {% if request.form.moisture == 'moist' %}selected{% endif %}>Moist (50–70%)</option>
                        <option value="wet" {% if request.form.moisture == 'wet' %}selected{% endif %}>Wet (70–90%)</option>
                    </select>
                </div>

                <div class="button-group">
                    <button type="submit">Get Recommendations</button>
                    <button type="submit" name="exit" value="1">Exit</button>
                </div>
            </form>
        </div>

        {% if crops %}
            <h2>Recommended Crops</h2>
            <div class="results-container">
                {% for crop in crops %}
                <div class="crop-card">
                    <h3>{{ crop.crop }}</h3>
                    <div class="crop-details">
                        <div class="detail-group">
                            <h4>Growing Conditions</h4>
                            <ul>
                                <li>pH Range: {{ crop.pH_min }} – {{ crop.pH_max }}</li>
                                <li>Soil Type: {{ crop.soil_type.capitalize() }}</li>
                                <li>Moisture Level: {{ crop.moisture_level.capitalize() }}</li>
                                {% if crop.sunlight is defined %}
                                <li>Sunlight Requirement: {{ crop.sunlight.capitalize() }}</li>
                                {% endif %}
                                {% if crop.water_requirement is defined %}
                                <li>Water Requirement: {{ crop.water_requirement }}</li>
                                {% endif %}
                            </ul>
                        </div>
                        {% if crop.planting_season is defined or crop.spacing is defined or crop.yield_per_hectare is defined or crop.pest_resistance is defined %}
                        <div class="detail-group">
                            <h4>Planting Information</h4>
                            <ul>
                                {% if crop.planting_season is defined %}
                                <li>Best Planting Season: {{ ", ".join(crop.planting_season) }}</li>
                                {% endif %}
                                {% if crop.spacing is defined %}
                                <li>Plant Spacing: {{ crop.spacing.between_plants }} × {{ crop.spacing.between_rows }}</li>
                                {% endif %}
                                {% if crop.yield_per_hectare is defined %}
                                <li>Expected Yield: {{ crop.yield_per_hectare }} per hectare</li>
                                {% endif %}
                                {% if crop.pest_resistance is defined %}
                                <li>Pest Resistance: {{ crop.pest_resistance.capitalize() }}</li>
                                {% endif %}
                            </ul>
                        </div>
                        {% endif %}
                        {% if crop.fertilizer_needs is defined %}
                        <div class="detail-group">
                            <h4>Fertilizer Requirements</h4>
                            <ul>
                                <li>Nitrogen: {{ crop.fertilizer_needs.nitrogen.capitalize() }}</li>
                                <li>Phosphorus: {{ crop.fertilizer_needs.phosphorus.capitalize() }}</li>
                                <li>Potassium: {{ crop.fertilizer_needs.potassium.capitalize() }}</li>
                            </ul>
                        </div>
                        {% endif %}
                        <div class="detail-group">
                            <h4>Timeline</h4>
                            <ul>
                                <li>Growing Duration: {{ crop.duration_days }} days</li>
                                <li>Expected Harvest: {{ crop.harvest_date }}</li>
                            </ul>
                        </div>
                        <div class="detail-group">
                            <h4>Growing Tips</h4>
                            <ul>
                                {% if crop.soil_type == 'loam' %}
                                <li>Ideal for most crops due to balanced drainage and nutrient retention</li>
                                <li>Regular watering and moderate fertilization recommended</li>
                                {% elif crop.soil_type == 'sandy' %}
                                <li>Water more frequently due to quick drainage</li>
                                <li>Add organic matter to improve nutrient retention</li>
                                {% elif crop.soil_type == 'clay' %}
                                <li>Improve drainage by adding organic matter</li>
                                <li>Avoid overwatering to prevent waterlogging</li>
                                {% endif %}
                                
                                {% if crop.moisture_level == 'dry' %}
                                <li>Monitor soil moisture carefully</li>
                                <li>Consider mulching to retain moisture</li>
                                {% elif crop.moisture_level == 'moist' %}
                                <li>Maintain consistent moisture levels</li>
                                <li>Water when top inch of soil feels dry</li>
                                {% elif crop.moisture_level == 'wet' %}
                                <li>Ensure good drainage to prevent root rot</li>
                                <li>Monitor for signs of overwatering</li>
                                {% endif %}

                                {% if crop.fertilizer_needs is defined and crop.fertilizer_needs.nitrogen == 'high' %}
                                <li>Apply nitrogen-rich fertilizers regularly</li>
                                {% endif %}
                                
                                {% if crop.pest_resistance is defined and crop.pest_resistance == 'low' %}
                                <li>Regular monitoring for pests recommended</li>
                                <li>Consider implementing pest control measures</li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% elif request.method == 'POST' %}
            <div class="error-message">
                <strong>No matching crops found for your input.</strong>
                <p>Please try different soil parameters.</p>
            </div>
        {% endif %}
    </div>
</body>
</html>

